# Part 7: Complete Architecture
## Putting It All Together

---

## ğŸ“‹ Table of Contents

| Section | Description |
|---------|-------------|
| [1. Architecture Overview](#1-architecture-overview) | The big picture |
| [2. Full Architecture Diagram](#2-full-architecture-diagram) | Visual representation |
| [3. All Resources Summary](#3-all-resources-summary) | Every resource created |
| [4. Terraform File Structure](#4-terraform-file-structure) | How files are organized |
| [5. Dependency Graph](#5-dependency-graph) | Build order |
| [6. End-to-End Request Flow](#6-end-to-end-request-flow) | Complete traffic journey |
| [7. Outputs](#7-outputs) | What Terraform exports |
| [8. Cost Estimation](#8-cost-estimation) | What this costs |
| [9. Production Checklist](#9-production-checklist) | What to change for prod |
| [10. Final Interview Questions](#10-final-interview-questions) | Comprehensive review |

---

## 1. Architecture Overview

### What We Built

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ARCHITECTURE SUMMARY                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   PROJECT:     devOps-interview-lab                             â”‚
â”‚   ENVIRONMENT: dev                                               â”‚
â”‚   REGION:      eu-west-2 (London)                               â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  NETWORKING                                              â”‚   â”‚
â”‚   â”‚  â€¢ 1 VPC (10.10.0.0/16)                                 â”‚   â”‚
â”‚   â”‚  â€¢ 2 Public Subnets (10.10.10.0/24, 10.10.20.0/24)     â”‚   â”‚
â”‚   â”‚  â€¢ 2 Private Subnets (10.10.30.0/24, 10.10.40.0/24)    â”‚   â”‚
â”‚   â”‚  â€¢ 1 Internet Gateway                                   â”‚   â”‚
â”‚   â”‚  â€¢ 1 NAT Gateway (single, cost-optimized)              â”‚   â”‚
â”‚   â”‚  â€¢ 2 Route Tables (public, private)                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  COMPUTE                                                 â”‚   â”‚
â”‚   â”‚  â€¢ 1 Bastion Host (t3.micro, public subnet)            â”‚   â”‚
â”‚   â”‚  â€¢ 1-2 App Servers (t3.micro, private subnets, ASG)    â”‚   â”‚
â”‚   â”‚  â€¢ 1 Launch Template                                    â”‚   â”‚
â”‚   â”‚  â€¢ 1 Auto Scaling Group (min:1, max:2)                 â”‚   â”‚
â”‚   â”‚  â€¢ 1 Scaling Policy (CPU target: 40%)                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  LOAD BALANCING                                          â”‚   â”‚
â”‚   â”‚  â€¢ 1 Application Load Balancer (internet-facing)       â”‚   â”‚
â”‚   â”‚  â€¢ 1 Target Group (HTTP:80)                            â”‚   â”‚
â”‚   â”‚  â€¢ 1 Listener (HTTP:80 â†’ forward)                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  SECURITY                                                â”‚   â”‚
â”‚   â”‚  â€¢ 3 Security Groups (bastion, alb, app)               â”‚   â”‚
â”‚   â”‚  â€¢ Defense in depth (layered security)                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Full Architecture Diagram

### Complete Infrastructure

```
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚  INTERNET   â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                                           â–¼
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                            VPC: 10.10.0.0/16                                      â•‘
â•‘                      (devOps-interview-lab-dev-vpc)                               â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                                   â•‘
â•‘                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â•‘
â•‘                           â”‚ INTERNET GATEWAY â”‚                                    â•‘
â•‘                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â•‘
â•‘                                    â”‚                                              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚                         PUBLIC SUBNETS                                     â”‚   â•‘
â•‘  â”‚                    Route: 0.0.0.0/0 â†’ IGW                                  â”‚   â•‘
â•‘  â”‚                                                                            â”‚   â•‘
â•‘  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â•‘
â•‘  â”‚    â”‚  PUBLIC SUBNET 1 (2a)   â”‚        â”‚  PUBLIC SUBNET 2 (2b)   â”‚         â”‚   â•‘
â•‘  â”‚    â”‚     10.10.10.0/24       â”‚        â”‚     10.10.20.0/24       â”‚         â”‚   â•‘
â•‘  â”‚    â”‚                         â”‚        â”‚                         â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚     BASTION       â”‚  â”‚        â”‚  â”‚    NAT GATEWAY    â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚    t3.micro       â”‚  â”‚        â”‚  â”‚                   â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚                   â”‚  â”‚        â”‚  â”‚  EIP: 52.x.x.x    â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚  Public: 3.x.x.x  â”‚  â”‚        â”‚  â”‚                   â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚  SG: bastion_sg   â”‚  â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚  â€¢ SSH:22  â†All   â”‚  â”‚        â”‚            â”‚            â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚  â€¢ HTTP:80 â†All   â”‚  â”‚        â”‚            â”‚            â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚            â”‚            â”‚         â”‚   â•‘
â•‘  â”‚    â”‚                         â”‚        â”‚            â”‚            â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚    ALB NODE       â”‚  â”‚        â”‚  â”‚    ALB NODE     â”‚   â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚         â”‚   â•‘
â•‘  â”‚    â”‚            â”‚            â”‚        â”‚           â”‚            â”‚         â”‚   â•‘
â•‘  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â•‘
â•‘  â”‚                 â”‚                                 â”‚                       â”‚   â•‘
â•‘  â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚   â•‘
â•‘  â”‚                              â”‚                                            â”‚   â•‘
â•‘  â”‚                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚   â•‘
â•‘  â”‚                 â”‚   APPLICATION LOAD      â”‚                               â”‚   â•‘
â•‘  â”‚                 â”‚      BALANCER           â”‚                               â”‚   â•‘
â•‘  â”‚                 â”‚                         â”‚                               â”‚   â•‘
â•‘  â”‚                 â”‚  DNS: devops-interview- â”‚                               â”‚   â•‘
â•‘  â”‚                 â”‚  lab-dev-alb-xxx.elb... â”‚                               â”‚   â•‘
â•‘  â”‚                 â”‚                         â”‚                               â”‚   â•‘
â•‘  â”‚                 â”‚  SG: alb_sg             â”‚                               â”‚   â•‘
â•‘  â”‚                 â”‚  â€¢ HTTP:80 â† 0.0.0.0/0  â”‚                               â”‚   â•‘
â•‘  â”‚                 â”‚                         â”‚                               â”‚   â•‘
â•‘  â”‚                 â”‚  Listener: HTTP:80      â”‚                               â”‚   â•‘
â•‘  â”‚                 â”‚  â†’ Forward to app_tg    â”‚                               â”‚   â•‘
â•‘  â”‚                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚   â•‘
â•‘  â”‚                              â”‚                                            â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                 â”‚                                                 â•‘
â•‘                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â•‘
â•‘                    â”‚      TARGET GROUP       â”‚                                    â•‘
â•‘                    â”‚        (app_tg)         â”‚                                    â•‘
â•‘                    â”‚  HTTP:80 | Health: /    â”‚                                    â•‘
â•‘                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â•‘
â•‘                                 â”‚                                                 â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚                         PRIVATE SUBNETS                                    â”‚   â•‘
â•‘  â”‚                    Route: 0.0.0.0/0 â†’ NAT                                  â”‚   â•‘
â•‘  â”‚                                                                            â”‚   â•‘
â•‘  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â•‘
â•‘  â”‚    â”‚  PRIVATE SUBNET 1 (2a)  â”‚        â”‚  PRIVATE SUBNET 2 (2b)  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚     10.10.30.0/24       â”‚        â”‚     10.10.40.0/24       â”‚         â”‚   â•‘
â•‘  â”‚    â”‚                         â”‚        â”‚                         â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚    APP SERVER     â”‚  â”‚        â”‚  â”‚    APP SERVER     â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚    (from ASG)     â”‚  â”‚        â”‚  â”‚    (from ASG)     â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚                   â”‚  â”‚        â”‚  â”‚                   â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚  IP: 10.10.30.x   â”‚  â”‚        â”‚  â”‚  IP: 10.10.40.x   â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚  (NO public IP)   â”‚  â”‚        â”‚  â”‚  (NO public IP)   â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚                   â”‚  â”‚        â”‚  â”‚                   â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚  SG: app_sg       â”‚  â”‚        â”‚  â”‚  SG: app_sg       â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚  â€¢ HTTP:80 â†VPC   â”‚  â”‚        â”‚  â”‚  â€¢ HTTP:80 â†VPC   â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚                   â”‚  â”‚        â”‚  â”‚                   â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â”‚  nginx â†’ :80      â”‚  â”‚        â”‚  â”‚  nginx â†’ :80      â”‚  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚   â•‘
â•‘  â”‚    â”‚                         â”‚        â”‚                         â”‚         â”‚   â•‘
â•‘  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â•‘
â•‘  â”‚                                                                            â”‚   â•‘
â•‘  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â•‘
â•‘  â”‚    â”‚                    AUTO SCALING GROUP                             â”‚   â”‚   â•‘
â•‘  â”‚    â”‚               (devOps-interview-lab-dev-app-asg)                  â”‚   â”‚   â•‘
â•‘  â”‚    â”‚                                                                   â”‚   â”‚   â•‘
â•‘  â”‚    â”‚  Launch Template: app-lt    â”‚  Capacity: min=1, max=2, desired=1  â”‚   â”‚   â•‘
â•‘  â”‚    â”‚  Scaling Policy: CPU 40%    â”‚  Health Check: ELB (60s grace)      â”‚   â”‚   â•‘
â•‘  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â•‘
â•‘  â”‚                                                                            â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                                                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Simplified Traffic Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User   â”‚â”€â”€â”€â”€â–¶â”‚ IGW â”‚â”€â”€â”€â”€â–¶â”‚ ALB â”‚â”€â”€â”€â”€â–¶â”‚ Target   â”‚â”€â”€â”€â”€â–¶â”‚ App Server  â”‚
â”‚ Browser  â”‚     â”‚     â”‚     â”‚     â”‚     â”‚  Group   â”‚     â”‚  (nginx)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚                                   â”‚
                         alb_sg                              app_sg
                      HTTP:80 â† All                     HTTP:80 â† VPC only
```

### Security Group Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SECURITY GROUPS                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚   â”‚ bastion_sg  â”‚      â”‚   alb_sg    â”‚      â”‚   app_sg    â”‚                 â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚   â”‚ IN:         â”‚      â”‚ IN:         â”‚      â”‚ IN:         â”‚                 â”‚
â”‚   â”‚ SSH:22 â†All â”‚      â”‚ HTTP:80â†All â”‚      â”‚ HTTP:80â†VPC â”‚                 â”‚
â”‚   â”‚ HTTP:80â†All â”‚      â”‚             â”‚      â”‚             â”‚                 â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                 â”‚
â”‚   â”‚ OUT:        â”‚      â”‚ OUT:        â”‚      â”‚ OUT:        â”‚                 â”‚
â”‚   â”‚ ALL â†’All    â”‚      â”‚ ALL â†’All    â”‚      â”‚ ALL â†’All    â”‚                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                                              â”‚
â”‚   Attached to:         Attached to:         Attached to:                    â”‚
â”‚   Bastion EC2          ALB                  App EC2s (via ASG)              â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Network Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              VPC: 10.10.0.0/16                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   eu-west-2a                              eu-west-2b                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚ PUBLIC: 10.10.10.0  â”‚                 â”‚ PUBLIC: 10.10.20.0  â”‚           â”‚
â”‚   â”‚  â€¢ Bastion          â”‚                 â”‚  â€¢ NAT Gateway      â”‚           â”‚
â”‚   â”‚  â€¢ ALB Node         â”‚                 â”‚  â€¢ ALB Node         â”‚           â”‚
â”‚   â”‚  Route â†’ IGW        â”‚                 â”‚  Route â†’ IGW        â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚ PRIVATE: 10.10.30.0 â”‚                 â”‚ PRIVATE: 10.10.40.0 â”‚           â”‚
â”‚   â”‚  â€¢ App Server(s)    â”‚                 â”‚  â€¢ App Server(s)    â”‚           â”‚
â”‚   â”‚  Route â†’ NAT        â”‚                 â”‚  Route â†’ NAT        â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. All Resources Summary

### Complete Resource List

| Category | Resource Type | Resource Name | Purpose |
|----------|--------------|---------------|---------|
| **State** | S3 Backend | devops-interview-lab-tfstate | Terraform state storage |
| **VPC** | aws_vpc | devOps-interview-lab-dev-vpc | Main network |
| **VPC** | aws_internet_gateway | - | Internet access for public subnets |
| **VPC** | aws_nat_gateway | - | Internet access for private subnets |
| **VPC** | aws_eip | - | Elastic IP for NAT Gateway |
| **VPC** | aws_subnet | public-eu-west-2a | Public subnet AZ-a (10.10.10.0/24) |
| **VPC** | aws_subnet | public-eu-west-2b | Public subnet AZ-b (10.10.20.0/24) |
| **VPC** | aws_subnet | private-eu-west-2a | Private subnet AZ-a (10.10.30.0/24) |
| **VPC** | aws_subnet | private-eu-west-2b | Private subnet AZ-b (10.10.40.0/24) |
| **VPC** | aws_route_table | public | Routes for public subnets |
| **VPC** | aws_route_table | private | Routes for private subnets |
| **Security** | aws_security_group | bastion_sg | Bastion access rules |
| **Security** | aws_security_group | alb_sg | ALB access rules |
| **Security** | aws_security_group | app_sg | App access rules |
| **Compute** | aws_instance | bastion | Jump server |
| **Compute** | aws_launch_template | app-lt | Template for app servers |
| **Compute** | aws_autoscaling_group | app-asg | Manages app servers |
| **Compute** | aws_autoscaling_policy | cpu-target | Scaling rules |
| **LB** | aws_lb | app_alb | Application Load Balancer |
| **LB** | aws_lb_target_group | app_tg | Target group for apps |
| **LB** | aws_lb_listener | http | HTTP listener |

### Resource Count

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RESOURCE COUNT                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   CATEGORY                COUNT                                 â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚   VPC Module              ~15 resources                         â”‚
â”‚   Security Groups         3 resources                           â”‚
â”‚   Bastion                 1 resource                            â”‚
â”‚   ALB + TG + Listener     3 resources                           â”‚
â”‚   ASG + LT + Policy       3 resources                           â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚   TOTAL                   ~25 resources                         â”‚
â”‚                                                                  â”‚
â”‚   All created from ~8 Terraform files!                         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Terraform File Structure

### Project Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FILE STRUCTURE                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   devops-interview-lab/                                         â”‚
â”‚   â”‚                                                              â”‚
â”‚   â”œâ”€â”€ _backend.tf          # S3 state configuration            â”‚
â”‚   â”‚                                                              â”‚
â”‚   â”œâ”€â”€ providers.tf         # AWS provider setup                 â”‚
â”‚   â”‚                                                              â”‚
â”‚   â”œâ”€â”€ variables.tf         # Input variable definitions         â”‚
â”‚   â”‚                                                              â”‚
â”‚   â”œâ”€â”€ terraform.tfvars     # Actual variable values             â”‚
â”‚   â”‚                                                              â”‚
â”‚   â”œâ”€â”€ vpc.tf               # VPC module (networking)            â”‚
â”‚   â”‚                                                              â”‚
â”‚   â”œâ”€â”€ bastion.tf           # Bastion host + security group      â”‚
â”‚   â”‚                                                              â”‚
â”‚   â”œâ”€â”€ alb.tf               # ALB + target group + listener      â”‚
â”‚   â”‚                                                              â”‚
â”‚   â”œâ”€â”€ app.tf               # App security group                 â”‚
â”‚   â”‚                                                              â”‚
â”‚   â”œâ”€â”€ app_asg.tf           # Launch template + ASG + policy     â”‚
â”‚   â”‚                                                              â”‚
â”‚   â””â”€â”€ outputs.tf           # Output values                      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### File Responsibilities

| File | Purpose | Creates |
|------|---------|---------|
| `_backend.tf` | State storage config | (configuration only) |
| `providers.tf` | AWS connection | (configuration only) |
| `variables.tf` | Variable schemas | (configuration only) |
| `terraform.tfvars` | Variable values | (configuration only) |
| `vpc.tf` | Networking | VPC, subnets, IGW, NAT, routes |
| `bastion.tf` | Admin access | Bastion EC2, bastion_sg |
| `alb.tf` | Load balancing | ALB, target group, listener, alb_sg |
| `app.tf` | App security | app_sg |
| `app_asg.tf` | App compute | Launch template, ASG, scaling policy |
| `outputs.tf` | Export values | (outputs only) |

---

## 5. Dependency Graph

### Build Order

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TERRAFORM DEPENDENCY GRAPH                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   LEVEL 0: Variables & Provider                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  terraform.tfvars â†’ variables.tf â†’ provider "aws"                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                          â”‚
â”‚                                       â–¼                                          â”‚
â”‚   LEVEL 1: VPC Module                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  module.vpc                                                              â”‚   â”‚
â”‚   â”‚  Creates: VPC, subnets, IGW, NAT, route tables                          â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚  Outputs: vpc_id, public_subnets, private_subnets, vpc_cidr_block       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                 â”‚                     â”‚                     â”‚                    â”‚
â”‚                 â–¼                     â–¼                     â–¼                    â”‚
â”‚   LEVEL 2: Security Groups + Bastion                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚  bastion_sg     â”‚   â”‚    alb_sg       â”‚   â”‚    app_sg       â”‚              â”‚
â”‚   â”‚  (needs vpc_id) â”‚   â”‚  (needs vpc_id) â”‚   â”‚ (needs vpc_id,  â”‚              â”‚
â”‚   â”‚                 â”‚   â”‚                 â”‚   â”‚  vpc_cidr_block)â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚            â”‚                     â”‚                     â”‚                        â”‚
â”‚            â–¼                     â”‚                     â”‚                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚                     â”‚                        â”‚
â”‚   â”‚    Bastion      â”‚            â”‚                     â”‚                        â”‚
â”‚   â”‚  (needs sg,     â”‚            â”‚                     â”‚                        â”‚
â”‚   â”‚   public_subnet)â”‚            â”‚                     â”‚                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚                     â”‚                        â”‚
â”‚                                  â–¼                     â–¼                        â”‚
â”‚   LEVEL 3: ALB + Target Group + Launch Template                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚       ALB           â”‚   â”‚   Target Group  â”‚   â”‚ Launch Template â”‚          â”‚
â”‚   â”‚  (needs alb_sg,     â”‚   â”‚   (needs vpc_id)â”‚   â”‚   (needs app_sg)â”‚          â”‚
â”‚   â”‚   public_subnets)   â”‚   â”‚                 â”‚   â”‚                 â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚              â”‚                       â”‚                     â”‚                    â”‚
â”‚              â”‚                       â”‚                     â”‚                    â”‚
â”‚              â–¼                       â–¼                     â–¼                    â”‚
â”‚   LEVEL 4: Listener + ASG                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚   â”‚     Listener        â”‚   â”‚              ASG                       â”‚          â”‚
â”‚   â”‚  (needs ALB arn,    â”‚   â”‚  (needs launch_template,              â”‚          â”‚
â”‚   â”‚   target_group arn) â”‚   â”‚   private_subnets, target_group_arns) â”‚          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                 â”‚                               â”‚
â”‚                                                 â–¼                               â”‚
â”‚   LEVEL 5: Scaling Policy                                                       â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                     Scaling Policy                                       â”‚   â”‚
â”‚   â”‚                     (needs ASG name)                                     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### How Terraform Determines Order

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              IMPLICIT DEPENDENCIES                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   Terraform automatically determines build order by analyzing   â”‚
â”‚   REFERENCES in your code:                                      â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  resource "aws_security_group" "app_sg" {                â”‚   â”‚
â”‚   â”‚    vpc_id = module.vpc.vpc_id  â—„â”€â”€ Reference!           â”‚   â”‚
â”‚   â”‚                     â”‚                                    â”‚   â”‚
â”‚   â”‚                     â”‚                                    â”‚   â”‚
â”‚   â”‚    Creates dependency: app_sg depends on module.vpc     â”‚   â”‚
â”‚   â”‚    Terraform builds VPC first, then app_sg              â”‚   â”‚
â”‚   â”‚  }                                                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚  resource "aws_autoscaling_group" "app" {                â”‚   â”‚
â”‚   â”‚    vpc_zone_identifier = module.vpc.private_subnets â—„â”€â”€ â”‚   â”‚
â”‚   â”‚    target_group_arns = [aws_lb_target_group.app_tg.arn] â”‚   â”‚
â”‚   â”‚                               â”‚                          â”‚   â”‚
â”‚   â”‚                               â”‚                          â”‚   â”‚
â”‚   â”‚    ASG depends on: VPC module AND target group          â”‚   â”‚
â”‚   â”‚  }                                                       â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   terraform graph | dot -Tpng > graph.png                       â”‚
â”‚   (generates visual dependency graph)                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. End-to-End Request Flow

### User Request Journey

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      END-TO-END REQUEST FLOW                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   STEP 1: User opens browser                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   User types: http://devops-interview-lab-dev-alb-xxx.eu-west-2.elb...  â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Browser: "I need to resolve this DNS name"                            â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                          â”‚
â”‚                                       â–¼                                          â”‚
â”‚   STEP 2: DNS Resolution                                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   DNS Query â†’ AWS Route 53 (ALB's DNS)                                  â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Response: 3.10.45.67, 3.11.23.89 (ALB public IPs, both AZs)          â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Browser picks one: 3.10.45.67                                         â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                          â”‚
â”‚                                       â–¼                                          â”‚
â”‚   STEP 3: TCP Connection + HTTP Request                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Browser â†’ 3.10.45.67:80                                               â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   GET / HTTP/1.1                                                        â”‚   â”‚
â”‚   â”‚   Host: devops-interview-lab-dev-alb-xxx.eu-west-2.elb.amazonaws.com   â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                          â”‚
â”‚                                       â–¼                                          â”‚
â”‚   STEP 4: ALB Security Group Check                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Inbound rule: HTTP:80 from 0.0.0.0/0                                  â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Source: User's IP (any)                                               â”‚   â”‚
â”‚   â”‚   Port: 80                                                               â”‚   â”‚
â”‚   â”‚   Protocol: TCP                                                          â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Result: âœ… ALLOWED                                                    â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                          â”‚
â”‚                                       â–¼                                          â”‚
â”‚   STEP 5: ALB Listener Receives Request                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Listener on port 80 catches the request                               â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Default action: forward to target group "app_tg"                      â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                          â”‚
â”‚                                       â–¼                                          â”‚
â”‚   STEP 6: Target Group Selection                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Target Group: app_tg                                                  â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Registered targets:                                                   â”‚   â”‚
â”‚   â”‚   â€¢ i-abc123 (10.10.30.15:80) - âœ… Healthy                             â”‚   â”‚
â”‚   â”‚   â€¢ i-def456 (10.10.40.22:80) - âœ… Healthy                             â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Algorithm: Round-robin                                                â”‚   â”‚
â”‚   â”‚   Selected: 10.10.30.15:80                                              â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                          â”‚
â”‚                                       â–¼                                          â”‚
â”‚   STEP 7: ALB Forwards to Target                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   ALB (10.10.10.100) â†’ App Server (10.10.30.15:80)                     â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   NEW request from ALB's private IP:                                    â”‚   â”‚
â”‚   â”‚   Source: 10.10.10.100 (ALB)                                            â”‚   â”‚
â”‚   â”‚   Destination: 10.10.30.15:80 (App)                                     â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                          â”‚
â”‚                                       â–¼                                          â”‚
â”‚   STEP 8: App Security Group Check                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Inbound rule: HTTP:80 from 10.10.0.0/16                               â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Source: 10.10.10.100 (ALB's private IP)                               â”‚   â”‚
â”‚   â”‚   Is 10.10.10.100 in 10.10.0.0/16? YES âœ…                               â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Result: âœ… ALLOWED                                                    â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                          â”‚
â”‚                                       â–¼                                          â”‚
â”‚   STEP 9: Nginx Serves Response                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   nginx receives: GET /                                                 â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   nginx serves: /usr/share/nginx/html/index.html                        â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   Response:                                                              â”‚   â”‚
â”‚   â”‚   HTTP/1.1 200 OK                                                       â”‚   â”‚
â”‚   â”‚   <h1>DevOps Interview Lab - App Server</h1>                            â”‚   â”‚
â”‚   â”‚   <p>Instance: i-abc123</p>                                             â”‚   â”‚
â”‚   â”‚   <p>Environment: dev</p>                                               â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                       â”‚                                          â”‚
â”‚                                       â–¼                                          â”‚
â”‚   STEP 10: Response Returns                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   App Server â†’ ALB â†’ Internet Gateway â†’ User's Browser                  â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   User sees: "DevOps Interview Lab - App Server"                        â”‚   â”‚
â”‚   â”‚              "Instance: i-abc123"                                       â”‚   â”‚
â”‚   â”‚              "Environment: dev"                                         â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â”‚   ğŸ‰ SUCCESS!                                                           â”‚   â”‚
â”‚   â”‚                                                                          â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. Outputs

### outputs.tf

```hcl
output "vpc_id" {
  description = "The ID of the VPC"
  value       = module.vpc.vpc_id
}

output "public_subnet_ids" {
  description = "List of public subnet IDs"
  value       = module.vpc.public_subnets
}

output "bastion_public_ip" {
  description = "Public IP of bastion host"
  value       = aws_instance.bastion.public_ip
}

output "app_private_ip" {
  description = "Note: ASG instances have dynamic IPs"
  value       = "Check ASG instances in AWS Console"
}

output "alb_dns_name" {
  description = "DNS name of the Application Load Balancer"
  value       = aws_lb.app_alb.dns_name
}
```

### Using Outputs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TERRAFORM OUTPUTS                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   After terraform apply:                                        â”‚
â”‚                                                                  â”‚
â”‚   $ terraform output                                            â”‚
â”‚                                                                  â”‚
â”‚   alb_dns_name = "devops-interview-lab-dev-alb-123456789.       â”‚
â”‚                   eu-west-2.elb.amazonaws.com"                  â”‚
â”‚   bastion_public_ip = "3.10.45.67"                              â”‚
â”‚   public_subnet_ids = [                                         â”‚
â”‚     "subnet-0abc123...",                                        â”‚
â”‚     "subnet-0def456...",                                        â”‚
â”‚   ]                                                              â”‚
â”‚   vpc_id = "vpc-0123456789abcdef"                               â”‚
â”‚                                                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                  â”‚
â”‚   ACCESS YOUR APP:                                              â”‚
â”‚   $ curl $(terraform output -raw alb_dns_name)                  â”‚
â”‚                                                                  â”‚
â”‚   SSH TO BASTION:                                               â”‚
â”‚   $ ssh -i key.pem ec2-user@$(terraform output -raw             â”‚
â”‚                                bastion_public_ip)               â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. Cost Estimation

### Monthly Cost Breakdown

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ESTIMATED MONTHLY COST                        â”‚
â”‚                    (eu-west-2, on-demand)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   RESOURCE                          COST/MONTH                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                 â”‚
â”‚                                                                  â”‚
â”‚   NAT Gateway                                                   â”‚
â”‚   â€¢ Hourly charge: $0.045 Ã— 730 hrs    $32.85                  â”‚
â”‚   â€¢ Data processing: varies            ~$5.00                   â”‚
â”‚                                        â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚                                        ~$38.00                  â”‚
â”‚                                                                  â”‚
â”‚   EC2 Instances                                                 â”‚
â”‚   â€¢ Bastion (t3.micro): $0.0104/hr     ~$7.60                  â”‚
â”‚   â€¢ App (t3.micro Ã— 1-2): $0.0104/hr   ~$7.60-$15.20           â”‚
â”‚                                        â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚                                        ~$15-$23                 â”‚
â”‚                                                                  â”‚
â”‚   Application Load Balancer                                     â”‚
â”‚   â€¢ Hourly: $0.0225 Ã— 730 hrs          $16.43                  â”‚
â”‚   â€¢ LCU (capacity units): varies       ~$5.00                   â”‚
â”‚                                        â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚                                        ~$21.00                  â”‚
â”‚                                                                  â”‚
â”‚   Data Transfer                                                 â”‚
â”‚   â€¢ Varies based on usage              ~$5-$20                  â”‚
â”‚                                                                  â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•               â”‚
â”‚   TOTAL ESTIMATED                      $79-$102/month          â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•               â”‚
â”‚                                                                  â”‚
â”‚   ğŸ’¡ COST SAVING TIPS:                                          â”‚
â”‚   â€¢ Use Reserved Instances for predictable workloads           â”‚
â”‚   â€¢ Stop bastion when not in use                               â”‚
â”‚   â€¢ Consider NAT Instance instead of NAT Gateway (~$4/mo)      â”‚
â”‚   â€¢ Use Spot Instances for non-critical workloads              â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. Production Checklist

### What to Change for Production

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PRODUCTION CHECKLIST                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚   â¬œ SECURITY                                                    â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ â–¡ Restrict bastion SSH to office IPs only               â”‚   â”‚
â”‚   â”‚   bastion_allowed_ssh_cidrs = ["YOUR.OFFICE.IP/32"]    â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Enable HTTPS on ALB (add certificate)                 â”‚   â”‚
â”‚   â”‚   - Request ACM certificate                             â”‚   â”‚
â”‚   â”‚   - Add HTTPS listener on port 443                      â”‚   â”‚
â”‚   â”‚   - Redirect HTTP to HTTPS                              â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Enable AWS WAF on ALB                                 â”‚   â”‚
â”‚   â”‚   - Protect against SQL injection, XSS                  â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Enable VPC Flow Logs                                  â”‚   â”‚
â”‚   â”‚   - Audit network traffic                               â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Use AWS Secrets Manager for sensitive data            â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   â¬œ HIGH AVAILABILITY                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ â–¡ Use multiple NAT Gateways (one per AZ)                â”‚   â”‚
â”‚   â”‚   single_nat_gateway = false                            â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Increase ASG capacity                                 â”‚   â”‚
â”‚   â”‚   min_size = 2, max_size = 10, desired = 2             â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Add more AZs (3 for production)                       â”‚   â”‚
â”‚   â”‚   azs = ["eu-west-2a", "eu-west-2b", "eu-west-2c"]     â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Enable cross-zone load balancing                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   â¬œ MONITORING & LOGGING                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ â–¡ Enable ALB access logs (to S3)                        â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Set up CloudWatch alarms                              â”‚   â”‚
â”‚   â”‚   - CPU, memory, disk                                   â”‚   â”‚
â”‚   â”‚   - Unhealthy host count                                â”‚   â”‚
â”‚   â”‚   - 5xx error rate                                      â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Enable CloudWatch Container Insights (if using ECS)   â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Set up CloudTrail for API auditing                    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   â¬œ BACKUP & DISASTER RECOVERY                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ â–¡ Enable S3 versioning on state bucket                  â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Set up state locking with DynamoDB                    â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Create AMI backups regularly                          â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Document runbooks for failover                        â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚   â¬œ COST OPTIMIZATION                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ â–¡ Use Reserved Instances (1yr = ~40% savings)           â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Enable Compute Optimizer recommendations              â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Set up billing alarms                                 â”‚   â”‚
â”‚   â”‚                                                          â”‚   â”‚
â”‚   â”‚ â–¡ Tag all resources for cost allocation                 â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. Final Interview Questions

### Architecture Questions

**Q1: Walk me through what happens when a user visits your application.**

> DNS resolves ALB name to public IPs â†’ Request hits ALB â†’ ALB SG allows HTTP:80 â†’ Listener forwards to target group â†’ Target group selects healthy instance (round-robin) â†’ ALB forwards to app (source IP becomes ALB's private IP) â†’ App SG allows HTTP from VPC CIDR â†’ nginx serves response â†’ Response returns through ALB to user.

**Q2: Why are app servers in private subnets?**

> Security - no public IPs means no direct attack surface. Defense in depth - attackers must go through ALB. Cost - no public IPv4 charges. Control - all traffic flows through known entry points (ALB).

**Q3: What happens if an AZ goes down?**

> ALB automatically routes traffic to healthy instances in other AZ. ASG launches replacement instances in available AZ. Single NAT Gateway in dev could be a problem - private subnets might lose internet access if NAT's AZ fails (use multiple NATs in prod).

**Q4: How would you scale this for 10x traffic?**

> Increase ASG max_size. Lower CPU target (e.g., 30%) for faster scale-out. Add more AZs. Consider larger instance types. Add caching (ElastiCache). Use CloudFront CDN for static content.

### Terraform Questions

**Q5: How does Terraform know what order to create resources?**

> Implicit dependencies through references. When you write `vpc_id = module.vpc.vpc_id`, Terraform knows the VPC must exist first. It builds a dependency graph and creates resources in the correct order.

**Q6: What's stored in the state file?**

> Resource IDs, attributes (IPs, ARNs), dependencies, metadata. It's Terraform's "memory" of what exists. Used to plan changes by comparing desired (.tf) vs actual (state).

**Q7: What happens if you delete the state file?**

> Terraform loses track of resources. Running `terraform apply` would try to create everything again (duplicates). You'd need to import existing resources or manually delete them in AWS.

**Q8: How would you manage multiple environments (dev/staging/prod)?**

> Separate state files per environment (different S3 keys). Use workspaces or separate directories. Same .tf files, different .tfvars files. Consider Terragrunt for DRY code.

### Security Questions

**Q9: How do the security groups implement defense in depth?**

> Layer 1: ALB SG only allows HTTP:80 from internet. Layer 2: Private subnets have no public IPs. Layer 3: App SG only allows traffic from VPC CIDR. Each layer must be breached to reach the app.

**Q10: What's the risk of 0.0.0.0/0 on the bastion?**

> Anyone on internet can attempt SSH. Brute force attacks are possible. For production: restrict to office IPs, use AWS Session Manager instead, implement fail2ban, use key-based auth only.

### Operations Questions

**Q11: How do you SSH to an app server?**

> SSH to bastion (public IP) first, then SSH to app server (private IP) from bastion. This is called SSH jump/proxy. Alternative: AWS Session Manager doesn't require bastion.

**Q12: How would you deploy new application code?**

> Update launch template with new AMI â†’ Trigger ASG instance refresh â†’ ASG gradually replaces instances. Or: Use CodeDeploy for in-place deployments. Or: Blue/green deployment with new ASG.

**Q13: An app server is unhealthy - how do you troubleshoot?**

> Check ALB target group health status. SSH via bastion to investigate. Check nginx status (`systemctl status nginx`). Check logs (`/var/log/nginx/`). Check security groups aren't blocking. Check user_data ran correctly (`/var/log/cloud-init-output.log`).

---

## ğŸ‰ Congratulations!

You've completed all 7 parts of the Terraform Infrastructure Guide!

### What You've Learned

| Part | Topic | Key Concepts |
|------|-------|--------------|
| 1 | Backend & Variables | State, providers, variable types |
| 2 | VPC & Networking | CIDR, subnets, IGW, NAT, routing |
| 3 | Bastion Host | Jump servers, AMI data sources, user data |
| 4 | ALB | Load balancing, target groups, health checks |
| 5 | ASG & App | Auto scaling, launch templates, scaling policies |
| 6 | Security Groups | Firewalls, defense in depth, traffic control |
| 7 | Complete Architecture | Full picture, flows, production readiness |

### Quick Reference Commands

```bash
# Initialize Terraform
terraform init

# Preview changes
terraform plan

# Apply changes
terraform apply

# Show outputs
terraform output

# Access your app
curl $(terraform output -raw alb_dns_name)

# SSH to bastion
ssh -i key.pem ec2-user@$(terraform output -raw bastion_public_ip)

# Destroy everything
terraform destroy
```

### Next Steps

1. **Practice** - Deploy this infrastructure yourself
2. **Modify** - Try adding a database (RDS)
3. **Improve** - Implement the production checklist
4. **Learn** - Explore Terraform modules, workspaces
5. **Certify** - Consider AWS Solutions Architect or Terraform Associate

---

## ğŸ“š All Parts Index

| Part | File | Description |
|------|------|-------------|
| 1 | [Part1-Backend-Providers-Variables.md](./Part1-Backend-Providers-Variables.md) | Foundation |
| 2 | [Part2-VPC-Networking.md](./Part2-VPC-Networking.md) | Networking |
| 3 | [Part3-Bastion-Host.md](./Part3-Bastion-Host.md) | Admin access |
| 4 | [Part4-ALB.md](./Part4-ALB.md) | Load balancing |
| 5 | [Part5-ASG-App-Layer.md](./Part5-ASG-App-Layer.md) | Auto scaling |
| 6 | [Part6-Security-Groups.md](./Part6-Security-Groups.md) | Security |
| 7 | [Part7-Complete-Architecture.md](./Part7-Complete-Architecture.md) | Full picture |

---

**Good luck with your DevOps interview! ğŸš€**